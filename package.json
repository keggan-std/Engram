{
  "name": "engram-mcp-server",
  "version": "1.7.2",
  "description": "Engram â€” Persistent Memory Cortex for AI coding agents. Gives agents session continuity, change tracking, decision logging, and project intelligence across sessions.",
  "type": "module",
  "main": "dist/index.js",
  "bin": {
    "engram": "dist/index.js",
    "engram-mcp-server": "dist/index.js"
  },
  "files": [
    "dist/",
    "scripts/"
  ],
  "repository": {
    "type": "git",
    "url": "git+https://github.com/keggan-std/Engram.git"
  },
  "releaseNotes": "# v1.7.1 â€” Hotfix: Enum Validation, Targeted Broadcasts & API Correctness\n\n**Released:** v1.7.1\n\n## Overview\n\nv1.7.1 is a hotfix release addressing **20 bugs** discovered during a systematic functional audit of the v1.7.0 tool surface. No new features â€” only correctness and reliability fixes. Zero breaking changes.\n\n| ID       | Area                 | Fix                                                              | Commit    |\n| -------- | -------------------- | ---------------------------------------------------------------- | --------- |\n| ISS-001â€“015 | API correctness   | Various: report, backup, tasks, events, session error messages   | `8dd7bce` |\n| ISS-007  | Universal Mode       | `discover` action used full-string includes instead of BM25       | `061b790` |\n| ISS-016  | `what_changed`       | `\"session_start\"` used as literal SQL string (always 0 results)  | `061b790` |\n| ISS-017  | `create_task`        | `priority` accepted any string â€” no enum validation              | `c89edb1` |\n| ISS-018  | `broadcast`          | `target_agent` column missing; all agents received all broadcasts | `b0efaf2` |\n| ISS-019  | `record_change`      | `change_type` + `impact_scope` accepted any string               | `c89edb1` |\n| ISS-020  | Universal Mode       | `set_file_notes` crashed when `dependencies` was a JSON string   | `13af958` |\n\n---\n\n## What's Fixed\n\n### ðŸ”’ Enum Validation â€” `change_type`, `impact_scope`, `priority`\n\n`record_change`, `create_task`, and related actions now reject invalid values with a clear Zod validation error.\n\n**Valid values:**\n- `change_type`: `created | modified | deleted | refactored | renamed | moved | config_changed`\n- `impact_scope`: `local | module | cross_module | global`  \n- `priority`: `critical | high | medium | low`\n\n### ðŸ“¡ Directed Broadcasts â€” `target_agent` Column + Query Filter\n\nThe `broadcasts` table now has a `target_agent TEXT` column (migration v16). The `broadcast` INSERT stores it; the `agent_sync` SELECT filters `WHERE target_agent IS NULL OR target_agent = ?`. Directed messages are now correctly scoped to their intended recipient.\n\n### â±ï¸ `what_changed { since: \"session_start\" }`\n\nThe `\"session_start\"` sentinel is now resolved to the session's `started_at` ISO timestamp before the SQL query executes.\n\n### ðŸ§© Universal Mode â€” Array Coercion Bypass Fixed\n\n`HandlerCapturer` (the duck-typed SDK stub used in Universal Mode) bypasses Zod `.transform()` preprocessing. `set_file_notes` with `dependencies` passed as a JSON string now works correctly â€” a `parseDepsField()` helper in `file-notes.repo.ts` handles both `string[]` and raw JSON string inputs.\n\n### âœ… API Correctness (ISS-001 â€“ ISS-015)\n\n- `generate_report` returns a full project knowledge summary\n- `get_global_knowledge` returns correct data shape\n- `backup` no longer throws `ENOENT`\n- `get_tasks { status: \"all\" }` returns all tasks regardless of status\n- `acknowledge_event { approved: false }` snoozes the event (was a no-op)\n- `config { op: \"get\", key: X }` returns only that key's value (was all config)\n- `record_milestone` version prefix no longer doubled (`v1.7.1` not `vv1.7.1`)\n- `dump` no longer creates a spurious `file_path: \"dump\"` change record\n- `NoActiveSessionError` message uses the correct v1.7 syntax\n- `checkpoint { progress: string }` accepts plain strings in `progress`\n- `update_task { id: N }` uses `id` (not `task_id`)\n\n---",
  "scripts": {
    "build": "tsc",
    "prepack": "node scripts/inject-release-notes.js && npm run clean && npm run build",
    "test": "vitest run",
    "test:coverage": "vitest run --coverage",
    "test:watch": "vitest",
    "start": "node dist/index.js",
    "dev": "tsc --watch",
    "clean": "node -e \"const {rmSync,existsSync}=require('fs');if(existsSync('dist'))rmSync('dist',{recursive:true,force:true})\"",
    "install-hooks": "node dist/scripts/install-hooks.js",
    "install-mcp": "node scripts/install-mcp.js",
    "install-mcp:list": "node scripts/install-mcp.js --list",
    "inspect": "npx @modelcontextprotocol/inspector node dist/index.js"
  },
  "keywords": [
    "mcp",
    "model-context-protocol",
    "ai-memory",
    "coding-agent",
    "persistent-memory",
    "session-continuity"
  ],
  "author": "",
  "license": "MIT",
  "dependencies": {
    "@modelcontextprotocol/sdk": "^1.12.0",
    "better-sqlite3": "^12.6.2",
    "zod": "^3.24.0"
  },
  "devDependencies": {
    "@types/better-sqlite3": "^7.6.13",
    "@types/node": "^22.10.0",
    "@vitest/coverage-v8": "^4.0.18",
    "typescript": "^5.7.0",
    "vitest": "^4.0.18"
  },
  "overrides": {
    "prebuild-install": "7.1.3"
  },
  "engines": {
    "node": ">=18.0.0"
  }
}
